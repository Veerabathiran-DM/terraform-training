#name: Deploy to GCP
#
#on:
#push:
#  branches:
#    - main
#
#jobs:
#deploy:
#  runs-on: ubuntu-latest
#
#  steps:
#  - name: Checkout Repository
#    uses: actions/checkout@v4
#
#  - name: Authenticate with Google Cloud
#    uses: google-github-actions/auth@v2
#    with:
#      credentials_json: ${{ secrets.GCLOUD_SERVICE_KEY }}
#
#  - name: Set up Google Cloud SDK
#    uses: google-github-actions/setup-gcloud@v2
#    with:
#      project_id: your-project-id
#
#  - name: Verify Authentication
#    run: gcloud auth list
#
#  - name: Deploy to GCS (Example)
#    run: gsutil cp -r . gs://test-bucket

name: Deploying GCP resources using Terraform

on:
push:
  branches:
    - main
  workflow_dispatch:

  jobs:
  deploy:
    run-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Authenticate with google cloud
        uses: google-github-actions/auth@v2
        with:
          credentials_json: ${{ secret.GCLOUD_SERVICE_KEY }}

      - name: Set-up gcloud SDK
        uses: google-github-actions/setup-gcloud@v2
        with:
          project_id: {{ secret.PROJECT_ID }}

      - name: Verifying Authentication
        run: gcloud auth list

      - name: Terraform Plan
        run: terraform plan

      - name: Terraform apply
        run: terraform apply
